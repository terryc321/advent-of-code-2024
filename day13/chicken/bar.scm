
(import (chicken pretty-print))
(import (srfi-1))


(define final
 #(((29 71) (52 31) (5388 4716))
  ((47 16) (14 21) (4795 2996))
  ((21 11) (12 60) (741 2859))
  ((61 34) (17 50) (2223 12510))
  ((49 84) (71 22) (6954 8830))
  ((63 94) (79 28) (3313 2966))
  ((63 34) (16 47) (2601 19683))
  ((58 16) (34 69) (1538 782))
  ((32 13) (33 65) (14263 17657))
  ((61 12) (28 67) (11219 19511))
  ((31 67) (63 23) (12991 911))
  ((13 29) (55 38) (2352 12511))
  ((55 31) (26 45) (8031 11372))
  ((27 17) (21 46) (13241 17761))
  ((17 36) (57 29) (9818 2628))
  ((26 43) (53 23) (9328 13971))
  ((22 80) (80 64) (5684 5920))
  ((45 98) (94 37) (9896 6625))
  ((13 67) (67 15) (4487 19239))
  ((49 13) (22 44) (8574 8268))
  ((46 16) (17 69) (15584 17398))
  ((71 85) (90 31) (12308 7751))
  ((55 26) (33 59) (3036 5211))
  ((33 71) (85 43) (5600 3376))
  ((47 65) (83 24) (4787 4623))
  ((64 69) (87 13) (6933 3354))
  ((86 11) (19 62) (3043 3189))
  ((88 21) (19 36) (3247 2946))
  ((12 31) (62 21) (10044 15067))
  ((13 34) (65 15) (14563 2264))
  ((82 26) (37 69) (7403 3779))
  ((48 76) (44 19) (10552 14750))
  ((20 72) (42 14) (5892 2256))
  ((21 67) (60 15) (3891 5357))
  ((26 56) (64 32) (1574 18312))
  ((75 34) (14 40) (2859 4022))
  ((58 51) (31 99) (4132 6216))
  ((35 61) (62 34) (17642 17366))
  ((66 23) (15 57) (7568 2293))
  ((23 68) (47 17) (5337 7242))
  ((11 59) (73 31) (1976 19532))
  ((35 89) (43 12) (5090 4669))
  ((48 70) (57 25) (9210 8200))
  ((44 80) (95 30) (7211 7830))
  ((28 17) (30 57) (17276 14123))
  ((24 99) (74 69) (4472 8997))
  ((44 79) (83 21) (8621 6389))
  ((50 29) (18 51) (5272 6262))
  ((55 22) (27 66) (6449 9098))
  ((67 48) (29 77) (4049 6724))
  ((73 12) (22 76) (17384 3832))
  ((57 24) (13 30) (11289 2744))
  ((58 83) (97 44) (7205 6613))
  ((58 23) (14 95) (4604 8266))
  ((47 78) (29 12) (18393 15038))
  ((32 24) (12 63) (3716 6405))
  ((60 82) (89 39) (10051 8861))
  ((34 69) (77 42) (9646 10206))
  ((34 48) (91 28) (7490 4144))
  ((21 93) (38 25) (1912 1733))
  ((16 71) (64 41) (5872 5888))
  ((95 83) (22 82) (8676 9024))
  ((76 34) (14 57) (7858 6103))
  ((18 48) (49 26) (7233 6394))
  ((60 22) (12 37) (3816 4594))
  ((37 81) (65 19) (3109 1751))
  ((57 63) (11 90) (4465 12330))
  ((55 22) (32 58) (18992 3264))
  ((27 90) (85 36) (5030 9594))
  ((89 39) (16 94) (2210 4274))
  ((70 42) (18 45) (7150 7368))
  ((55 35) (14 45) (13106 9340))
  ((23 56) (69 34) (8219 8774))
  ((66 20) (24 92) (2736 3032))
  ((75 24) (23 27) (6819 3714))
  ((54 76) (79 14) (6844 6328))
  ((36 63) (49 27) (7784 13157))
  ((67 18) (15 66) (1604 15416))
  ((58 28) (12 41) (3908 2802))
  ((16 85) (32 14) (2400 3546))
  ((40 23) (35 61) (9350 1199))
  ((18 36) (40 11) (11872 621))
  ((79 55) (32 88) (7757 10461))
  ((87 23) (12 79) (2631 3577))
  ((11 49) (68 30) (15642 2000))
  ((47 19) (37 64) (12590 18040))
  ((91 21) (22 53) (2355 2700))
  ((11 81) (25 29) (867 2507))
  ((45 34) (13 34) (3230 8812))
  ((13 29) (86 19) (7194 2739))
  ((29 12) (42 58) (9035 938))
  ((18 79) (99 75) (8559 7007))
  ((39 12) (30 73) (18224 4138))
  ((47 15) (39 46) (5397 3333))
  ((11 44) (71 22) (626 14004))
  ((31 70) (38 20) (5135 5870))
  ((31 64) (46 15) (4718 5317))
  ((52 15) (34 61) (19776 4845))
  ((63 21) (18 68) (12698 734))
  ((11 58) (64 24) (19282 4620))
  ((11 49) (84 30) (8877 7387))
  ((16 98) (29 27) (1699 8147))
  ((68 85) (84 17) (1320 1122))
  ((47 18) (12 19) (9197 14349))
  ((18 82) (57 57) (4212 8244))
  ((21 50) (48 21) (19220 13256))
  ((15 97) (79 42) (4719 6604))
  ((37 71) (92 58) (4093 4535))
  ((16 66) (80 21) (17136 1205))
  ((40 30) (16 55) (1392 2635))
  ((38 14) (21 41) (17360 12000))
  ((22 95) (72 21) (2082 7251))
  ((64 18) (61 89) (4725 3125))
  ((18 89) (96 50) (7764 9936))
  ((64 20) (16 87) (6624 7810))
  ((49 24) (11 56) (7663 19448))
  ((80 14) (59 64) (6788 6126))
  ((90 39) (56 90) (13578 11997))
  ((17 44) (44 21) (16409 13862))
  ((30 25) (27 81) (4479 8237))
  ((34 72) (32 11) (17594 6142))
  ((22 70) (69 12) (4853 1628))
  ((44 79) (43 13) (5208 13828))
  ((29 46) (44 21) (16486 17474))
  ((91 37) (34 98) (7377 6619))
  ((19 94) (66 63) (4170 10353))
  ((93 87) (89 17) (6270 1890))
  ((37 18) (15 48) (11639 11552))
  ((31 14) (38 67) (2853 13372))
  ((42 12) (32 58) (11178 16954))
  ((49 99) (53 12) (7435 9507))
  ((43 29) (11 39) (14616 1736))
  ((39 11) (59 79) (6578 7530))
  ((73 16) (11 62) (4992 7314))
  ((78 13) (30 51) (5592 4842))
  ((74 24) (14 94) (1686 8956))
  ((31 56) (44 20) (19755 17496))
  ((39 22) (24 58) (2379 1920))
  ((28 48) (41 23) (17638 290))
  ((21 44) (43 14) (12687 15890))
  ((22 13) (20 99) (2730 10157))
  ((66 17) (77 85) (7447 3417))
  ((31 15) (28 46) (9921 6127))
  ((15 53) (64 19) (11172 1343))
  ((18 75) (66 18) (14042 16058))
  ((19 90) (66 11) (6241 6337))
  ((96 80) (17 83) (8419 12729))
  ((39 48) (51 17) (6522 4869))
  ((29 15) (16 46) (8057 12355))
  ((17 44) (44 24) (1866 12616))
  ((21 44) (66 30) (9695 1532))
  ((54 21) (20 49) (2434 6402))
  ((55 66) (55 18) (5060 2568))
  ((70 11) (14 57) (9832 524))
  ((18 73) (65 17) (13511 4266))
  ((14 69) (62 33) (3316 6258))
  ((71 16) (31 37) (6052 1724))
  ((41 63) (50 14) (6977 6951))
  ((44 21) (16 38) (15596 7785))
  ((44 80) (45 14) (18455 16762))
  ((64 28) (11 29) (5092 18412))
  ((49 30) (18 61) (2349 4287))
  ((78 39) (16 55) (18792 11304))
  ((70 15) (85 84) (4365 1659))
  ((83 99) (73 26) (9696 8939))
  ((19 64) (51 18) (12732 18462))
  ((12 85) (56 34) (600 986))
  ((56 32) (11 61) (380 436))
  ((46 98) (71 11) (2140 2876))
  ((60 19) (19 62) (18888 13062))
  ((45 68) (37 11) (12993 9189))
  ((38 80) (60 18) (9222 2250))
  ((34 23) (48 99) (1970 3262))
  ((25 48) (98 38) (5093 3622))
  ((15 55) (54 32) (3627 4501))
  ((14 55) (87 34) (6042 7116))
  ((97 11) (75 98) (10393 2700))
  ((48 16) (12 49) (5664 6028))
  ((55 85) (88 18) (3861 3961))
  ((69 27) (50 77) (7731 4059))
  ((41 11) (24 45) (18974 2387))
  ((18 48) (64 22) (19244 14654))
  ((24 40) (87 36) (3177 1916))
  ((11 52) (42 20) (10250 12128))
  ((26 22) (16 66) (3032 5346))
  ((81 27) (52 98) (10266 7536))
  ((37 20) (18 48) (16841 16484))
  ((62 19) (15 52) (3367 8360))
  ((49 22) (19 30) (4357 766))
  ((41 17) (17 33) (10150 13358))
  ((94 38) (56 84) (11506 10358))
  ((20 41) (51 31) (8049 8659))
  ((38 76) (59 38) (4712 3344))
  ((59 23) (11 23) (19102 5206))
  ((30 78) (67 19) (1112 5864))
  ((52 18) (15 24) (5023 2886))
  ((41 18) (40 67) (12191 18022))
  ((34 12) (53 78) (19655 10970))
  ((62 97) (62 23) (5642 2833))
  ((54 28) (27 46) (17432 5168))
  ((12 31) (84 60) (16064 15470))
  ((52 14) (23 69) (7657 12397))
  ((35 13) (13 42) (2589 3861))
  ((15 33) (22 13) (11329 14497))
  ((63 71) (71 20) (10736 7178))
  ((15 37) (94 35) (2897 2618))
  ((22 79) (57 44) (4278 5721))
  ((62 76) (80 13) (13004 7519))
  ((25 13) (18 46) (10630 18270))
  ((51 16) (37 73) (3377 6155))
  ((15 35) (66 35) (10817 12170))
  ((32 55) (51 17) (10777 9727))
  ((13 60) (73 33) (367 11945))
  ((17 68) (70 19) (7935 18594))
  ((28 54) (66 40) (16520 9812))
  ((23 72) (74 25) (14040 4926))
  ((78 73) (83 12) (9936 3782))
  ((27 41) (82 35) (4765 3655))
  ((51 25) (17 49) (1230 18502))
  ((58 40) (40 95) (9102 11940))
  ((75 34) (20 57) (2100 14380))
  ((89 30) (56 73) (8039 3684))
  ((64 13) (13 80) (15579 5585))
  ((70 13) (68 99) (4644 2849))
  ((53 19) (32 70) (1587 1951))
  ((71 19) (13 55) (18219 10159))
  ((88 24) (63 94) (12746 9468))
  ((18 54) (49 18) (13757 18944))
  ((62 19) (11 51) (11171 10870))
  ((85 98) (79 18) (1932 912))
  ((36 13) (14 49) (2160 3944))
  ((19 61) (87 47) (9370 7548))
  ((96 11) (42 71) (3900 6139))
  ((85 91) (68 20) (10098 6534))
  ((16 19) (92 12) (2304 791))
  ((12 96) (78 20) (1686 3220))
  ((22 42) (39 11) (1749 5985))
  ((42 16) (23 48) (8578 4160))
  ((20 49) (78 26) (2818 1786))
  ((21 53) (50 18) (11452 12732))
  ((37 18) (25 39) (13915 6356))
  ((21 98) (21 18) (1743 7414))
  ((84 79) (15 86) (2124 3723))
  ((41 54) (55 18) (8532 6120))
  ((38 64) (30 15) (1248 1569))
  ((68 33) (26 57) (15350 19079))
  ((12 61) (90 78) (7584 9710))
  ((69 14) (14 90) (3911 3234))
  ((59 35) (13 34) (9247 16339))
  ((40 11) (11 66) (11174 1255))
  ((87 99) (54 11) (5433 4114))
  ((17 78) (57 49) (1895 3594))
  ((81 65) (22 63) (3521 5909))
  ((58 99) (66 35) (5042 3015))
  ((19 50) (49 22) (12558 2900))
  ((57 29) (17 44) (13239 1533))
  ((31 69) (49 16) (3513 17917))
  ((70 38) (17 51) (3714 9326))
  ((47 14) (36 75) (1969 6868))
  ((12 49) (66 35) (18962 15964))
  ((46 61) (74 21) (10072 6646))
  ((68 19) (75 90) (4839 2802))
  ((39 13) (28 38) (3130 1932))
  ((60 20) (22 56) (11652 10996))
  ((21 47) (76 50) (16051 14205))
  ((24 92) (85 69) (7673 9637))
  ((72 16) (69 73) (2067 863))
  ((85 31) (47 59) (4672 4048))
  ((79 62) (35 89) (7740 7182))
  ((20 84) (66 43) (6530 5177))
  ((60 18) (62 99) (3418 3357))
  ((67 11) (18 61) (15779 4864))
  ((72 29) (38 65) (6958 4840))
  ((41 64) (72 17) (1910 1646))
  ((17 59) (32 15) (13963 3310))
  ((13 34) (54 39) (17275 10735))
  ((68 22) (11 43) (4043 14171))
  ((49 41) (69 11) (5997 3943))
  ((13 67) (54 15) (18389 14300))
  ((35 12) (25 39) (8260 16295))
  ((11 82) (80 12) (8144 6364))
  ((80 23) (50 60) (5060 1911))
  ((39 22) (15 89) (807 1019))
  ((19 47) (17 11) (19529 7457))
  ((88 33) (13 21) (1447 591))
  ((28 80) (70 16) (3980 11856))
  ((51 27) (31 54) (8544 12140))
  ((28 64) (59 21) (18595 9393))
  ((26 80) (60 34) (6396 5974))
  ((43 25) (24 85) (3675 2705))
  ((49 15) (39 70) (1505 13780))
  ((65 11) (40 51) (3450 805))
  ((26 71) (77 52) (6108 8133))
  ((71 31) (15 61) (1068 3570))
  ((16 77) (94 54) (9970 10135))
  ((44 15) (20 54) (16592 14516))
  ((12 22) (38 17) (5624 2372))
  ((28 56) (63 32) (5499 1824))
  ((11 68) (36 17) (1596 2261))
  ((35 16) (12 42) (18101 16340))
  ((86 86) (50 12) (2780 2628))
  ((74 50) (11 63) (1900 6396))
  ((52 67) (97 29) (12679 8370))
  ((24 91) (85 46) (4074 3843))
  ((29 68) (35 13) (12015 1641))
  ((56 18) (21 68) (9601 18358))
  ((84 40) (32 59) (3612 5396))
  ((77 19) (11 92) (3663 8136))
  ((25 38) (38 13) (1657 8142))
  ((13 29) (63 35) (15775 16167))
  ((14 44) (80 24) (7254 4604))
  ((51 34) (26 94) (4065 8230))
  ((14 81) (94 31) (7968 5072))
  ((50 78) (80 26) (5740 3718))
  ((96 73) (18 78) (1728 4401))
  ((19 57) (58 12) (13020 11432))
  ((75 15) (64 86) (11389 7841))
  ((16 50) (33 19) (960 1654))
  ((11 67) (64 12) (7909 5285))
  ((67 89) (90 27) (9541 5825))))

#|

Button A: X+94, Y+34
Button B: X+22, Y+67
Prize: X=8400, Y=5400

Button A: X+26, Y+66
Button B: X+67, Y+21
Prize: X=12748, Y=12176

Button A: X+17, Y+86
Button B: X+84, Y+37
Prize: X=7870, Y=6450

Button A: X+69, Y+23
Button B: X+27, Y+71
Prize: X=18641, Y=10279

|#

(import bindings)
;; binding form not quoted  , value match against is quoted  xprs .. follow 
;; ((29 71) (52 31) (5388 4716))
;; is there a solution where some amount of  
;;      button A  +  button B  = prize C
;;           a * A + b * B = C 
;; suppose a is 0 , just b what would b maximum be ? x3 / x2
;;                    b maximum on y axis ?  y3 / y2 
(define solve 
  (lambda (triple)
    (let ((solved #f))
      (bind ((x1 y1)(x2 y2)(x3 y3)) triple
            ;; x3 y3 coords much much larger now 
            (let ((x3 (+ x3 10000000000000))
                  (y3 (+ y3 10000000000000)))
              (list x1 y1 x2 y2 x3 y3)
              ;; maximum y possible , maximum x possible , min of those two gives a max value
              (let ((bmax (min (+ 1 (floor (/ y3 y2)))
                               (+ 1 (floor (/ x3 x2)))))
                    (amax (min (+ 1 (floor (/ y3 y1)))
                               (+ 1 (floor (/ x3 x1))))))                
                (let loop2 ((b 0))
                  (let loop ((a 0))
                    (let ((cx (+ (* a x1) (* b x2)))
                          (cy (+ (* a y1) (* b y2))))
                      ;; found solution ?
                      (when  (and (= cx x3)(= cy y3))                      
                        ;; warning message ?
                        ;; (when (or (> a 100) (> b 100))
                        ;;   (fmt #t "exceeded 100 button press solution ~a ~a ~%" a b))
                        ;;(fmt #t "position ~a ~a ~%" cx cy)
                        (set! solved (+ (* 3 a) b)))
                      ;; keep trying
                      (if (and (not solved) (< a amax))
                          (loop (+ a 1)))))
                  (if (and (not solved) (< b bmax))
                      (loop2 (+ b 1))))))
            (cond 
             ((not solved) 0)
             (#t solved))))))



(define example-1 (lambda () (solve '((94 34)(22 67)(8400 5400)))))
(define example-2 (lambda () (solve '((26 66)(67 21)(12748 12176)))))
(define example-3 (lambda () (solve '((17 86)(84 37)(7870 6450)))))
(define example-4 (lambda () (solve '((69 23)(27 71)(18641 10279)))))

(define part-1 (lambda () 
                 (let ((size (vector-length final))
                       (tot 0))
                   (let loop ((i 0))
                     (let* ((triple (vector-ref final i))
                            (prize (solve triple)))                       
                       (set! tot (+ tot prize))
                       (when (< i (- size 1))
                         (loop (+ i 1)))))
                   tot)))


;; accepted answer
;; (part-1)
;; 35082

;; how would go about solving this then ?







